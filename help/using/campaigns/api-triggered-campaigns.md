---
solution: Journey Optimizer
product: journey optimizer
title: Api を使用してキャンペーンをトリガーします。
description: Api を使用したキャンペーンの開始方法について説明し  [!DNL Journey Optimizer]  ます。
exl-id: 0ef03d33-da11-43fa-8e10-8e4b80c90acb
source-git-commit: 2160d52f24af50417cdcf8c6ec553b746a544c2f
workflow-type: tm+mt
source-wordcount: '769'
ht-degree: 0%

---

# Api を使用してキャンペーンをトリガーします。 {#trigger-campaigns}

## API によってトリガーされるキャンペーンについて {#about}

で [!DNL Journey Optimizer] は、インタラクティブなメッセージ実行 REST API ](https://developer.adobe.com/journey-optimizer-apis/references/messaging/#tag/execution) を使用して、キャンペーンを作成してから、ユーザートリガーに基づいて [ 外部システムからそのキャンペーンを起動することができます。これにより、パスワードのリセット、OTP トークンなど、様々な操作上のメッセージングおよびトランザクションのニーズに対応できます。

これを行うには、最初に、旅のオプティマイザーで API トリガキャンペーンを作成してから、API 呼び出しを使用して、その実行を開始する必要があります。

API によってトリガーされたキャンペーンで利用可能なチャンネルは、電子メール、SMS、およびメッセージをプッシュすることです。

## API トリガキャンペーンの作成 {#create}

API によってトリガーされるキャンペーンを作成するプロセスは、API ペイロードで実行される対象ユーザーの選択を除けば、定期的なキャンペーンと同じです。 キャンペーンの作成方法について詳しくは [ ](create-campaign.md) 、ここを参照してください。

API によってトリガーされたキャンペーンを作成するには、次の手順を実行します。

1. タイプを使用して **[!UICONTROL API-triggered]** 新しいキャンペーンを作成します。

1. メッセージの送信に使用するチャンネルとチャンネルを選択し、をクリック **[!UICONTROL Create]** します。

   ![](assets/api-triggered-type.png)

1. キャンペーンのタイトルと説明を指定し、次に、送信するメッセージを設定します。

   ![](assets/api-triggered-properties.png)

   >[!NOTE]
   >
   >追加のデータを API ペイロードに渡すことができます。これは、メッセージをカスタマイズするために使用することができます。 [詳細情報](#contextual)
   >
   >コンテンツ内の大きな状況にあるコンテキストデータを使用すると、パフォーマンスに影響を与える可能性があります。

1. **[!UICONTROL Audience]**&#x200B;セクションで、セグメントから人物を識別するために使用する名前空間を指定します。

   **[!UICONTROL Create new profiles]**&#x200B;このオプションを使用すると、データベースに存在しないプロファイルを自動的に作成することができます。[キャンペーン実行時のプロファイル作成に関する詳細情報](#profile-creation)

1. キャンペーンの開始日と終了日を設定します。

   キャンペーンに開始日と終了日を設定すると、その日付の範囲外には実行されず、キャンペーンが Api によって開始された場合は API 呼び出しが失敗します。

1. **[!UICONTROL cURL request]**&#x200B;セクションで、API ペイロードに使用するを取得 **[!UICONTROL Campaign ID]** します。

   ![](assets/api-triggered-curl.png)

1. **[!UICONTROL Review to activate]**&#x200B;キャンペーンが正しく設定されていることを確認してから、アクティブにします。

## API トリガキャンペーンでのコンテキスト属性の使用 {#contextual}

API トリガキャンペーンを使用すると、API ペイロードに追加のデータを渡して、キャンペーン内でメッセージをカスタマイズすることができます。

次の例では、お客様によってパスワードがリセットされるようにしています。また、ユーザーに対して、サードパーティ製ツールで生成されたパスワードリセット URL を送信することになります。 API によってトリガーされるキャンペーンの場合は、生成された URL を API ペイロードに渡し、キャンペーン内でそれを活用してメッセージに追加できます。

>[!NOTE]
>
>プロファイルが有効なイベントとは異なり、REST API で渡される文脈データは、one-off 通信に使用され、プロファイルには格納されません。 最大数は、名前空間の詳細が見つからない場合に、名前空間の詳細を使用してプロファイルが作成されます。

このようなデータをキャンペーンで使用するには、それらのデータを API ペイロードに渡して、式エディターを使用してメッセージに追加する必要があります。 これを行うには、次のシンタックスを使用 `{{context.<contextualAttribute>}}` します。ここで、ここ `<contextualAttribute>` では、渡すデータが含まれている API ペイロードの変数の名前と一致する必要があります。

シンタックスは、 `{{context.<contextualAttribute>}}` String データ型のみにマップされます。

![](assets/api-triggered-context.png)

>[!IMPORTANT]
>
>`context.system`シンタックスは、Adobe internal usage only に制限されているので、コンテキスト属性を指定するために使用することはできません。

ここで、左の手すりメニューでは、文脈属性を使用できないことに注意してください。 属性は、によって [!DNL Journey Optimizer] チェックが実行されるのではなく、パーソナル化式に直接入力する必要があります。

## キャンペーンの実行 {#execute}

API によってトリガーされたキャンペーンを実行するには、まずその ID を取得して API ペイロードに渡す必要があります。 この操作を行うには、キャンペーンを開き、セクションから **[!UICONTROL cURL request]** ID をコピーしてペーストします。

![](assets/api-triggered-id.png)

これにより、この ID を API ペイロードに使用して、キャンペーンを開始することができます。 詳細については、 [ インタラクティブメッセージ実行 API のマニュアル ](https://developer.adobe.com/journey-optimizer-apis/references/messaging/#tag/execution) を参照してください。

キャンペーンの作成時に特定の開始日と終了日を設定している場合は、日付の範囲外では実行されず、API 呼び出しが失敗します。

## キャンペーン実行時のプロファイル作成 {#profile-creation}

場合によっては、システムに存在しないプロファイルに対して、トランザクションメッセージを送信する必要があります。 例えば、不明なユーザーが web サイトのパスワードを再設定しようとするとします。

プロファイルがデータベース内に存在しない場合は、このプロファイルにメッセージを送信することを許可するためにキャンペーンの実行時に自動的に作成することができます。

>[!IMPORTANT]
>
>この機能を使用すると、大規模なトランザクションの送信を非常に簡単 **に行う** ことができます。この機能を使用すると、多数のプロファイルが既にプラットフォームに既に存在しています。

キャンペーンの実行 **[!UICONTROL Create new profiles]** 時にプロファイル作成をアクティブにするには、「」セクションで **[!UICONTROL Audience]** オプションをオンにします。

![](assets/api-triggered-create-profile.png)

>[!NOTE]
>
>AJO インタラクティブメッセージプロファイルデータ **セットデータセットに** 、次の3つのデフォルトの名前空間 (email、tel、および d) ごとに、不明なプロファイルが作成されます (電子メール、SMS、プッシュ)。
