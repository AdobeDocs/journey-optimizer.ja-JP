---
title: API を使用したキャンペーンのトリガー
description: ' [!DNL Journey Optimizer] API を使用してキャンペーンをトリガーする方法を説明します'
hide: true
hidefromtoc: true
exl-id: 0ef03d33-da11-43fa-8e10-8e4b80c90acb
source-git-commit: 711fdf1dce0688d2e21d405a4e3e8777612b2f3b
workflow-type: tm+mt
source-wordcount: '687'
ht-degree: 100%

---

# API を使用したキャンペーンのトリガー {#trigger-campaigns}

## API トリガーキャンペーンについて {#about}

>[!NOTE]
>
>インタラクティブメッセージ実行 API は現在ベータ版です。予告なしに頻繁に更新される可能性があります。

[!DNL Journey Optimizer] を使用すると、キャンペーンを作成したあと、[インタラクティブメッセージ実行 REST API](https://developer.adobe.com/journey-optimizer-apis/references/messaging/#tag/execution) を使用して、ユーザートリガーに基づいて外部システムからそれらのキャンペーンを呼び出すことができます。これにより、パスワードのリセットや OTP トークンなど、運用上のメッセージおよびトランザクションメッセージの様々なニーズに対応できます。

それには、まず Journey Optimizer で API トリガーキャンペーンを作成し、次に API 呼び出しを通じてその実行を開始する必要があります。

API トリガーキャンペーンで使用できるチャネルは、メール、SMS およびプッシュメッセージです。

## API トリガーキャンペーンの作成 {#create}

API トリガーキャンペーンを作成するプロセスは、API ペイロードで実行されるオーディエンスの選択を除き、スケジュール済みキャンペーンと同じです。キャンペーンの作成方法について詳しくは、[この節](create-campaign.md)を参照してください。

API トリガーキャンペーンを作成するには、次の手順に従います。

1. **[!UICONTROL API トリガー]**&#x200B;タイプの新しいキャンペーンを作成します。

1. メッセージの送信に使用するチャネルとチャネルサーフェスを選択し、「**[!UICONTROL 作成]**」をクリックします。

   ![](assets/api-triggered-type.png)

1. キャンペーンのタイトルと説明を指定し、送信するメッセージを設定します。

   ![](assets/api-triggered-properties.png)

   >[!NOTE]
   >
   >追加のデータを API ペイロードに渡して、メッセージのパーソナライズに利用できます。[詳細情報](#contextual)

1. セグメントから個人を識別するために使用する名前空間を指定します。

1. キャンペーンの開始日と終了日を設定します。

   キャンペーンの特定の開始日や終了日を設定した場合、そのキャンペーンはこれらの日付以外では実行されず、キャンペーンが API によってトリガーされると API 呼び出しは失敗します。

1. 「**[!UICONTROL cURL リクエスト]**」セクションで、API ペイロードで使用する&#x200B;**[!UICONTROL キャンペーン ID]** を取得します。

   ![](assets/api-triggered-curl.png)

1. 「**[!UICONTROL アクティブ化するレビュー]**」をクリックして、キャンペーンが正しく設定されていることを確認してからアクティブ化します。

## API トリガーキャンペーンでのコンテキスト属性の使用 {#contextual}

API トリガーキャンペーンを使用すると、追加のデータを API ペイロードに渡し、キャンペーン内で使用してメッセージをパーソナライズできます。

この例では、パスワードのリセットを希望する顧客に、サードパーティツールで生成されるパスワードリセット URL を送信するとします。API トリガーキャンペーンを使用すると、生成されたこの URL を API ペイロードに渡し、キャンペーンに活用してメッセージに追加できます。

>[!NOTE]
>
>プロファイル対応のイベントとは異なり、REST API で渡されるコンテキストデータは、1 回限りの通信に使用され、プロファイルに対しては保存されません。プロファイルが見つからなかった場合、名前空間の詳細を最大限に使用してプロファイルが作成されます。

これらのデータをキャンペーンで使用するには、データを API ペイロードに渡し、式エディターを使用してメッセージに追加する必要があります。それには、`{{context.<contextualAttribute>}}` 構文を使用します。ここで、`<contextualAttribute>` は、渡すデータを含んだ API ペイロード内の変数の名前と一致する必要があります。

この `{{context.<contextualAttribute>}}` 構文は String データタイプにのみマッピングされます。

![](assets/api-triggered-context.png)

>[!IMPORTANT]
>
>`context.system` 構文はアドビ内部での使用のみに制限されているので、コンテキスト属性を渡すために使用しないでください。なお、現時点では、左側のパネルメニューで使用できるコンテキスト属性はありません。 属性はパーソナライゼーション式に直接入力する必要がありますが、[!DNL Journey Optimizer] によるチェックは行われません。

## キャンペーンの実行 {#execute}

API トリガーキャンペーンを実行するには、まずその ID を取得して、API ペイロードに渡す必要があります。それには、キャンペーンを開き、「**[!UICONTROL cURL リクエスト]**」セクションから ID をコピー＆ペーストします。

![](assets/api-triggered-id.png)

その後、この ID を API ペイロードに使用して、キャンペーンをトリガーできます。詳しくは、[インタラクティブメッセージ実行 API ドキュメント](https://developer.adobe.com/journey-optimizer-apis/references/messaging/#tag/execution)を参照してください。

なお、キャンペーンを作成する際に特定の開始日や終了日を設定している場合、そのキャンペーンはこれらの日付以外では実行されず、API 呼び出しは失敗します。

>[!NOTE]
>
>場合によっては、システムに存在しないプロファイルにトランザクションメッセージを送信する必要があります。例えば、不明なユーザーが web サイトにログインしようとした場合などです。その場合、対応するプロファイルが Adobe Experience Platform の **AJO インタラクティブメッセージプロファイルデータセット**&#x200B;データセットに自動的に作成されます。
