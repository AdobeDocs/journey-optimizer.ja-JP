---
solution: Journey Optimizer
product: journey optimizer
title: ビジュアルフラグメントの使用
description: Journey Optimizer のキャンペーンやジャーニーでメールを作成する際に、ビジュアルフラグメントを使用する方法を説明します
feature: Email Design, Fragments
topic: Content Management
role: User
level: Beginner
exl-id: 25a00f74-ed08-479c-9a5d-4185b5f3c684
source-git-commit: 288e3418b7152410166ddb9e520997933f1f589c
workflow-type: tm+mt
source-wordcount: '1023'
ht-degree: 97%

---

# メールへのビジュアルフラグメントの追加 {#use-visual-fragments}

フラグメントは、Journey Optimizer キャンペーン、ジャーニー、コンテンツテンプレート全体で 1 つ以上のメールで参照できる再利用可能なコンポーネントです。この機能を使用すると、マーケティングユーザーが改善されたデザインプロセスでメールコンテンツを迅速に組み立てるために使用できる複数のカスタムコンテンツブロックを事前に作成できます。[詳しくは、フラグメントの作成と管理の方法を参照してください](../content-management/fragments.md)。

➡️ [フラグメントの管理、作成、使用方法について詳しくは、このビデオをご覧ください](../content-management/fragments.md#video-fragments)

## フラグメントの使用 {#use-fragment}

メールにフラグメントを使用するには、次の手順に従います。

>[!NOTE]
>
>1 回の配信で最大 30 個のフラグメントを追加できます。フラグメントをネストできるのは 1 レベルまでです。

1. [E メールデザイナー](get-started-email-design.md)を使用して、メールまたはテンプレートのコンテンツを開きます。

1. 左パネルから「**[!UICONTROL フラグメント]**」アイコンを選択します。

   ![](assets/fragments-in-designer.png)

1. 現在のサンドボックスで作成されたすべてのビジュアルフラグメントのリストが表示されます。フラグメントは作成日で並べ替えられます。最近追加したビジュアルフラグメントがリストの最初に表示されます。次のことができます。

   * ラベルの入力を開始して、特定のフラグメントを検索します。
   * フラグメントを昇順または降順に並べ替えます。
   * フラグメントの表示方法（カード表示またはリスト表示）を変更します。
   * リストの更新

   >[!NOTE]
   >
   >コンテンツの編集中に一部のフラグメントが変更または追加された場合、リストは最新の変更内容に更新されます。

1. リストからフラグメントを挿入する領域にドラッグ＆ドロップします。

   ![](assets/fragment-insert.png)

   >[!CAUTION]
   >
   >**ドラフト**&#x200B;または&#x200B;**ライブ**&#x200B;フラグメントをコンテンツに追加できます。ただし、ジャーニーまたはキャンペーンでドラフトステータスのフラグメントを使用している場合、そのジャーニーまたはキャンペーンはアクティブ化できません。ジャーニーまたはキャンペーンの公開時に、ドラフトフラグメントにエラーが表示されるので、公開するには承認する必要があります。

1. 他のコンポーネントと同様に、コンテンツ内でフラグメントを移動できます。

1. フラグメントを選択すると、右側に対応するパネルが表示されます。ここから、コンテンツからフラグメントを削除したり、複製したりできます。また、これらのアクションは、フラグメントの上部に表示されるコンテキストメニューから直接実行することもできます。

   ![](assets/fragment-right-pane.png)

1. 「**[!UICONTROL 設定]**」タブから、次の操作を実行できます。

   * フラグメントを表示するデバイスを選択します。
   * 必要に応じて、新しいタブでフラグメントを開いて編集します。[詳細情報](../content-management/fragments.md#fragments)
   * 参照を探索します。[詳細情報](../content-management/fragments.md#visual-expression)

1. 「**[!UICONTROL スタイル]**」タブを使用して、フラグメントをさらにカスタマイズできます。

1. 必要に応じて、元のフラグメントの継承を解除できます。[詳細情報](#break-inheritance)

1. 必要な数のフラグメントを追加し、変更内容を&#x200B;**[!UICONTROL 保存]**&#x200B;します。

### フラグメントで動的コンテンツを使用する際の制限 {#fragment-dynamic-content}

>[!CAUTION]
>
>動的コンテンツ（条件付きコンテンツ）を含むフラグメントを操作する際は、次の制限に注意してください。
>
>**動的コンテンツを含むフラグメントのネストはサポートされていません。**&#x200B;動的コンテンツを含むフラグメントは、動的コンテンツも含むロック解除されたフラグメント内に配置できません。 このサポートされていない設定により、次の問題が発生する場合があります。
>
>* 条件付きコンテンツマッピングの消失
>* E メールデザイナーでの互換性モードに関する警告
>* メールレンダリングの一貫性の欠如
>
>**推奨されるアプローチ：**&#x200B;メールで動的コンテンツを含む複数のフラグメントを使用する際は、各フラグメントをメールレベルで独自の構造ブロックに直接追加します。これにより、適切な機能が確保され、上記の問題を防ぐことができます。

## 動的コンテンツを含むフラグメントのベストプラクティス {#fragment-best-practices}

ビジュアルフラグメントと動的コンテンツ（条件付きコンテンツ）を操作する際は、次のベストプラクティスに従います。

* **メールを適切に構造化**：動的コンテンツを含むフラグメントを使用してメールを作成する際は、各フラグメントをメールレベルの専用の構造ブロックに追加します。動的コンテンツを含むフラグメントを、動的コンテンツも含む他のロック解除されたフラグメント内にネストすることは回避します。

* **事前に計画**：メールにフラグメントを追加する前に、動的コンテンツを含むフラグメントを特定し、それに応じてレイアウトを計画します。これにより、設定の問題を防ぎ、最初からクリーンな構造を確保できます。

* **再利用可能なフラグメントを慎重にデザイン**：動的コンテンツを含むフラグメントを作成する際は、その使用方法を考慮します。フラグメントを他のフラグメント内にネストする必要がある場合は、親フラグメントと子フラグメントの両方に動的コンテンツを追加することを回避します。

* **トラブルシューティング**：条件付きコンテンツのマッピングが消失したり、互換性モードに関する警告が表示されたりする場合は、次の操作を実行します。
   * 動的コンテンツを含むネストされたフラグメントのメール構造を確認
   * 動的コンテンツを含む各フラグメントをメールレベルで独自の構造ブロックに移動して再構築
   * 保存して、条件付きコンテンツマッピングが適切に復元されていることを確認

## 暗黙的変数の使用 {#implicit-variables-in-fragments}

暗黙的変数は、既存のフラグメント機能を強化して、コンテンツの再利用性とスクリプトのユースケースの効率を向上させます。フラグメントでは入力変数を使用し、キャンペーンおよびジャーニーコンテンツで使用可能な出力変数を作成できます。

暗黙的変数の使用方法については、[この節](../personalization/use-expression-fragments.md#implicit-variables)を参照してください。

## 編集可能フィールドのカスタマイズ {#customize-fields}

選択したフラグメントの一部が編集可能になっている場合は、そのフラグメントをコンテンツに追加した後で、そのデフォルト値を上書きできます。[詳しくは、フラグメントをカスタマイズ可能にする方法を参照してください](../content-management/customizable-fragments.md)

>[!CAUTION]
>
>ボタンコンポーネントの **label** と **URL** の両方がフラグメントで編集可能な場合、トラッキングレポートには、ボタンラベルではなく URL が表示されます。<!--If accurate label tracking is critical for your reporting, one potential approach is to break the inheritance on the fragment after adding it to your email, though note that this disconnects the fragment from centralized updates. [Learn more about breaking inheritance](#break-inheritance)-->

フラグメント内の編集可能フィールドをカスタマイズするには、次の手順に従います。

1. コンテンツにフラグメントを追加します。

1. これを選択すると、右側にプロパティパネルが開きます。

   フラグメント内のすべての編集可能フィールドが「**設定**」タブの「**フラグメント**」セクションに表示されます。

1. 右側のパネルで編集可能なフィールドを選択すると、中央のプレビューパネルでそのフィールドが緑色でハイライト表示され、コンテンツ内の場所を簡単に特定できます。

   次の例では、画像の&#x200B;**ソース**&#x200B;と&#x200B;**代替テキスト**&#x200B;のほか、「ここをクリック」ボタンの **URL** が編集可能です。

   ![](assets/fragment-editable.png)

## 継承の解除 {#break-inheritance}

ビジュアルフラグメントを編集すると、変更内容が同期されます。これらは、そのフラグメントを含むすべてのドラフトまたはライブのジャーニー／キャンペーンおよびコンテンツテンプレートに自動的に生成されます。

メールまたはコンテンツテンプレートに追加すると、フラグメントはデフォルトで同期されます。ただし、元のフラグメントからの継承を解除することはできます。フラグメントのコンテンツは現在のデザインにコピーされ、変更内容は同期されなくなります。

継承を解除するには、次の手順に従います。

1. フラグメントを選択します。

1. コンテキストツールバーのロック解除アイコンをクリックします。

   ![](assets/fragment-break-inheritance.png)

1. そのフラグメントは、元のフラグメントにリンクされなくなったスタンドアロン要素になります。コンテンツ内の他のコンテンツコンポーネントと同様に編集します。[詳細情報](content-components.md)
