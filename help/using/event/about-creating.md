---
title: 単一イベントの設定
description: 単一イベントの構成方法を説明します
source-git-commit: 4464ea7169424c1ec6212394b8bda79a9bec1913
workflow-type: tm+mt
source-wordcount: '1674'
ht-degree: 99%

---

# 単一イベントの設定 {#configure-an-event}

![](../assets/do-not-localize/badge.png)

単一イベントは、特定のプロファイルにリンクされます。 ルールベースによるものと、システムで生成されるものがあります。単一イベントの詳細については、[このセクション](../event/about-events.md)を参照してください。

新規のイベントを設定する最初の手順は次のとおりです。

1. 「管理」セクションで、「**[!UICONTROL 設定]**」を参照し、「**[!UICONTROL イベント]**」をクリックします。 イベントのリストが表示されます。

   ![](../assets/jo-event1.png)

1. 新しいイベントを作成するには、**[!UICONTROL 追加]**&#x200B;をクリックします。画面の右側にイベント設定ペインが開きます。

   ![](../assets/jo-event2.png)

1. イベントの名前を入力します。 説明を追加することもできます。

   ![](../assets/jo-event3.png)

   >[!NOTE]
   >
   >スペースや特殊文字は使用しないでください。30 文字以内にしてください。

1. **[!UICONTROL タイプ]**&#x200B;フィールドで、**単一イベント**&#x200B;を選択します。

   ![](../assets/jo-event3bis.png)

1. **[!UICONTROL イベント ID タイプ]**&#x200B;フィールドで、使用するイベント ID の種類として、**ルールベース**&#x200B;または&#x200B;**システム生成**&#x200B;を選択します。イベント ID のタイプの詳細については、[このセクション](../event/about-events.md#event-id-type)を参照してください。

   ![](../assets/jo-event4.png)

1. このイベントを使用するジャーニーの数は、「**[!UICONTROL 使用されている場所]**」フィールドに表示されます。**[!UICONTROL ジャーニーを表示]**&#x200B;アイコンをクリックすると、このイベントを使用するジャーニーのリストを表示できます。

1. スキーマとペイロードのフィールドを定義します。ジャーニーが受け取るイベント情報（通常、ペイロードと呼びます）は、ここで選択します。その後、この情報をジャーニーに使うことができます。詳しくは、[このセクション](../event/about-creating.md#define-the-payload-fields)を参照してください。

   ![](../assets/jo-event5.png)

   >[!NOTE]
   >
   >**[!UICONTROL システム生成]**&#x200B;タイプを選択した場合は、eventID タイプが Mixin のスキーマのみを使用できます。 **[!UICONTROL ルールベース]**&#x200B;タイプを選択した場合は、すべてのエクスペリエンスイベントのスキーマを使用できます。

1. ルールベースのイベントの場合は、**[!UICONTROL イベント ID 条件]**フィールド内でクリックします。 簡単な式エディターを使用して、ジャーニーをトリガーするイベントを識別するためにシステムが使用する条件を定義します。
   ![](../assets/jo-event6.png)

   この例では、プロファイルの都市に基づいて条件を作成しました。 つまり、システムはこの条件（**[!UICONTROL 市区町村]**&#x200B;フィールドと&#x200B;**[!UICONTROL パリ]**&#x200B;という値）を満たすイベントを受け取るたびに、ジャーニーにイベントを渡します。

1. 名前空間を追加します。この手順はオプションですが、名前空間を追加すると、リアルタイム顧客プロファイルサービスに保存された情報を活用できるのでお勧めです。これは、イベントのキーのタイプを定義します。詳しくは、[このセクション](../event/about-creating.md#select-the-namespace)を参照してください。
1. キーを定義します。ペイロードフィールドからフィールドを選択するか、イベントに関連付けられた個人を識別する数式を定義します。このキーは、名前空間を選択した場合に自動的に設定されます（ただし、編集は可能です）。確かに、ジャーニーは名前空間に対応するキーを選択します（たとえば、メール名前空間を選択すると、メールのキーが選択されます）。詳しくは、[このセクション](../event/about-creating.md#define-the-event-key)を参照してください。

   ![](../assets/jo-event7.png)

1. システム生成イベントの場合は、条件を追加できます。 この手順はオプションです。これにより、条件を満たすイベントのみが処理されます。条件は、イベントに含まれる情報に基づく場合にのみ指定できます。詳しくは、[このセクション](../event/about-creating.md#add-a-condition)を参照してください。
1. **[!UICONTROL 保存]**&#x200B;をクリックします。

   ![](../assets/journey7.png)

   これでイベントが設定され、ジャーニーに含まれる準備が整いました。イベントを受信するには、追加の設定手順が必要です。[このページ](../event/additional-steps-to-send-events-to-journey-orchestration.md)をご覧ください。

## ペイロードフィールドの定義 {#define-the-payload-fields}

ペイロード定義を使用すると、ジャーニーのイベントからシステムが受け取ると想定される情報と、イベントに関連付けられている人を識別するためのキーを選択できます。 ペイロードは Experience Cloud XDM フィールド定義に基づいています。XDMについて詳しくは、 [このページ](https://experienceleague.adobe.com/docs/experience-platform/xdm/home.html?lang=ja)を参照してください。

1. リストからXDMスキーマを選択し、「**[!UICONTROL ペイロード]**」フィールドまたは&#x200B;**[!UICONTROL 編集]**&#x200B;アイコンをクリックします。

   ![](../assets/journey8.png)

   スキーマで定義されているすべてのフィールドが表示されます。 フィールドのリストは、スキーマによって異なります。特定のフィールドを検索し、フィルターを使用してすべてのノードとフィールドを表示、または選択したフィールドのみを表示できます。スキーマ定義によって、一部のフィールドが必須で、事前に選択されている場合があります。選択を解除することはできません。 ジャーニーがイベントを適切に受け取るために必須のフィールドはすべて、デフォルトで選択されます。

   >[!NOTE]
   >
   >XDM スキーマに「オーケストレーション」ミックスインが追加されていることを確認してください。 これにより、[!DNL Journey Optimizer]と連携するために必要な情報がスキーマにすべて含まれるようになります。

   ![](../assets/journey9.png)

1. イベントから受け取るフィールドを選択します。 これらはビジネスユーザーがジャーニーで活用するフィールドです。 また、イベントに関連付けられた人物を識別するために使用するキーも含める必要があります（[このセクション](../event/about-creating.md#define-the-event-key)を参照）。

   ![](../assets/journey10.png)

   >[!NOTE]
   >
   >システム生成イベントの場合、**[!UICONTROL eventID]**&#x200B;フィールドが選択されたフィールドのリストに自動的に追加され、[!DNL Journey Optimizer]がイベントを識別できるようになります。 イベントをプッシュするシステムでは ID を生成しないため、ペイロードプレビューにある ID を使用する必要があります。詳しくは、[この節](../event/about-creating.md#preview-the-payload)を参照してください。

1. 必要なフィールドの選択が完了したら、「**[!UICONTROL 保存]**」をクリックするか、**[!UICONTROL Enter]**&#x200B;キーを押します。

   ![](../assets/journey11.png)

   選択したフィールドの数が&#x200B;**[!UICONTROL ペイロード]**&#x200B;フィールドに表示されます。

   ![](../assets/journey12.png)

## 名前空間の選択 {#select-the-namespace}

名前空間を使用すると、イベントに関連付けられた人物を識別するために使用するキーのタイプを定義できます。 設定は必須ではありません。[リアルタイム顧客プロファイル](https://experienceleague.adobe.com/docs/experience-platform/sources/home.html?lang=ja)からの追加情報をジャーニーで取得する場合に必要です。 カスタムデータソースを介したサードパーティデータのみを使用する場合は、名前空間は必要ありません。

事前定義済みのいずれかを使用するか、ID 名前空間サービスを使用して新規作成できます。 この[ページ](https://experienceleague.adobe.com/docs/experience-platform/sources/home.html?lang=ja)を参照してください。

プライマリ ID を持つスキーマを選択した場合は、**[!UICONTROL キー]**&#x200B;と&#x200B;**[!UICONTROL 名前空間]**&#x200B;フィールドに事前入力されます。 ID が定義されていない場合は、_identityMap > id_&#x200B;をプライマリキーとして選択します。次に名前空間を選択します。キーには&#x200B;_identityMap > id_&#x200B;を使用して、(**[!UICONTROL 名前空間]**&#x200B;フィールドの下)事前入力されます。

フィールドを選択すると、メイン IDフィールドにタグが付けられます。

![](../assets/primary-identity.png)


ドロップダウンリストから言語を選択します。

![](../assets/journey17.png)

1つのジャーニーで許可される名前空間は 1 つだけです。 同じジャーニーで複数のイベントを使用する場合は、同じ名前空間を使用する必要があります。 [こちらのページ](../building-journeys/journey.md)を参照してください。

## イベントキーの定義 {#define-the-event-key}

キーは、イベントのペイロードデータの一部とするフィールドまたはフィールドの組み合わせで、イベントに関連付けられた人を識別できます。 キーには、Experience CloudID、CRM ID、電子メールアドレスなどがあります。

リアルタイム顧客プロファイルデータベースに保存されたデータを活用する場合は、イベントキーとして[リアルタイム顧客プロファイルサービス](https://experienceleague.adobe.com/docs/experience-platform/profile/home.html)でプロファイルの ID として定義した情報を選択する必要があります。

これによりイベントと個人のプロファイルの間の調整を実行できます。 プライマリ ID を持つスキーマを選択した場合は、**[!UICONTROL キー]**&#x200B;と&#x200B;**[!UICONTROL 名前空間]**&#x200B;フィールドに事前入力されます。 ID が定義されていない場合は、_identityMap > id_&#x200B;をプライマリキーとして選択します。次に名前空間を選択します。キーには&#x200B;_identityMap > id_&#x200B;を使用して、(**[!UICONTROL 名前空間]**&#x200B;フィールドの下)事前入力されます。

フィールドを選択すると、メイン ID フィールドにタグ付けされます。

![](../assets/primary-identity.png)

CRM ID や電子メールアドレスなど、別のキーを使用する必要がある場合は、キーを手動で追加する必要があります。

1. **[!UICONTROL キー]**&#x200B;フィールド内または鉛筆アイコン上をクリックします。

   ![](../assets/journey16.png)

1. ペイロードフィールドのリストでキーとして選択したフィールドを選択します。 詳細式エディタに切り替えて、より複雑なキーを作成することもできます(例えば、2 つのフィールドのイベントを連結したキー)。 この節では、以下を参照してください。

   ![](../assets/journey20.png)

イベントを受け取ると、キーの値によって、イベントに関連付けられた人物を識別できます。 名前空間に関連付けられている（[このセクション](../event/about-creating.md#select-the-namespace)を参照）。キーはAdobe Experience Platformでクエリを行うのに使用できます。 [このページ](../building-journeys/about-journey-activities.md#orchestration-activities)を参照してください。
このキーは、人がジャーニーにいるかどうかを確認するためにも使用されます。 同じジャーニーの2つの異なる場所にいる人はいません。 その結果、同じキー（例えば、キーCRMID=3224）を同じジャーニー内の異なる場所に置くことはできません。

また、より高度な操作を実行する場合は、高度な式関数（**[!UICONTROL 高度なモード]**）にアクセスできます。 これらの関数を使用すると、形式の変更、フィールドの連結など、特定のクエリ（先頭の10文字など）を実行する際に使用する値を操作できます。 [このページ](https://experienceleague.adobe.com/docs/journeys/using/building-advanced-conditions-journeys/expressionadvanced.html?lang=ja)を参照してください。

## 条件を追加します {#add-a-condition}

この条件は、システム生成イベントでのみ使用できます。システムがイベントの処理をフィルタリングするイベント条件を定義できます。条件がtrueの場合、イベントが処理されます。 条件がtrueでない場合、イベントは無視されます。

イベントの条件は、イベントのペイロードで渡されたデータに基づく場合にのみ指定できます。 イベントレベルで定義された条件は、マーケターがキャンバス上で変更することはできません。 このイベントを使用する際に、この条件を強化する必要があります。例えば、買い物かごの値が小さすぎる場合に買い物かごの放棄イベントをマーケターが使用したくない場合、「買い物かごの値」イベントフィールドに条件を作成し、100ドルを超える値を課すことができます。

イベントに条件を設定するには、単純な式エディターまたは高度な式エディターを使用します。[このページ](https://experienceleague.adobe.com/docs/journeys/using/building-advanced-conditions-journeys/expressionadvanced.html)を参照してください。

例えば、特定のイベントタイプのイベントのみを処理し、他のタイプは無視する条件を定義できます。または、イベントが買い物かご放棄で、ペイロードに買い物かご値フィールドが含まれている場合、買い物かご値が100ドルを超える場合にのみイベントを処理するイベント条件を定義できます。

![](../assets/journey78.png)

## ペイロードのプレビュー {#preview-the-payload}

ペイロードのプレビューを使用して、ペイロード定義を検証できます。

>[!NOTE]
>
>システム生成イベントの場合、イベントを作成する際に、ペイロードプレビューを表示する前に、イベントを保存し、再度開きます。この手順は、ペイロードでイベントIDを生成するために必要です。

1. 「**[!UICONTROL 表示ペイロード]**」アイコンをクリックして、システムが予想するペイロードをプレビューします。

   ![](../assets/journey13.png)

   選択したフィールドが表示されていることに注意してください。

   ![](../assets/journey14.png)

1. ペイロード定義を検証するプレビューを確認します。

1. その後、イベント送信の担当者とペイロードプレビューを共有できます。 このペイロードは、[!DNL Journey Optimizer]にプッシュするイベントのセットアップを設計するのに役立ちます。 [このページ](../event/additional-steps-to-send-events-to-journey-orchestration.md)をご覧ください。
