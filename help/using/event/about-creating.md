---
solution: Journey Optimizer
product: journey optimizer
title: 単一イベントの設定
description: 単一イベントの構成方法を学ぶ
feature: Journeys, Events
topic: Administration
role: Data Engineer, Data Architect, Admin
level: Intermediate, Experienced
keywords: イベント, 単一, 作成, ジャーニー
exl-id: e22e2bc7-0c15-457a-8980-97bea5da7784
source-git-commit: 0571a11eabffeb5e318bebe341a8df18da7db598
workflow-type: tm+mt
source-wordcount: '1605'
ht-degree: 99%

---

# 単一イベントの設定 {#configure-an-event}

>[!CONTEXTUALHELP]
>id="ajo_journey_event_unitary"
>title="単一イベント"
>abstract="イベントの設定を使用すると、Journey Optimizer が受け取る情報を定義できます。複数のイベントを（ジャーニーの様々なステップで）使用できます。また、同じイベントを複数のジャーニーで使用することもできます。単一イベントは、特定のプロファイルにリンクされます。ルールベースによるものと、システムで生成されるものがあります。"

単一イベントは、特定のプロファイルにリンクされます。ルールベースによるものと、システムで生成されるものがあります。単一イベントの詳細については、[この節](../event/about-events.md)を参照してください。

新規イベントを設定する最初の手順は次のとおりです。

1. 管理メニューセクションで、「**[!UICONTROL 設定]**」を選択します。「**[!UICONTROL イベント]**」セクションで、「**[!UICONTROL 管理]**」をクリックします。イベントのリストが表示されます。

   ![](assets/jo-event1.png)

1. 新しいイベントを作成するには、「**[!UICONTROL イベントを作成]**」をクリックします。画面の右側にイベント設定ペインが開きます。


   ![](assets/jo-event2.png)

1. イベントの名前を入力します。説明を追加することもできます。

   ![](assets/jo-event3.png)

   >[!NOTE]
   >
   >英数字とアンダースコアのみを使用できます。 最大長は 30 文字です。

1. 「**[!UICONTROL タイプ]**」フィールドで「**単一**」を選択します。

   ![](assets/jo-event3bis.png)

1. 「**[!UICONTROL イベント ID タイプ]**」フィールドで、使用するイベント ID タイプとして「**ルールベース**」または「**システム生成**」を選択します。イベント ID のタイプの詳細については、[この節](../event/about-events.md#event-id-type)を参照してください。

   ![](assets/jo-event4.png)

1. このイベントを使用するジャーニーの数は、「**[!UICONTROL 使用されている場所]**」フィールドに表示されます。**[!UICONTROL ジャーニーを表示]**&#x200B;アイコンをクリックすると、このイベントを使用するジャーニーのリストを表示できます。

1. スキーマとペイロードのフィールドを定義します。ジャーニーが受け取るイベント情報（通常、ペイロードと呼びます）は、ここで選択します。その後、この情報をジャーニーに使うことができます。[この節](../event/about-creating.md#define-the-payload-fields)を参照してください。

   ![](assets/jo-event5.png)

   >[!NOTE]
   >
   >**[!UICONTROL システム生成]**&#x200B;タイプを選択した場合は、eventID タイプのフィールドを持つスキーマのみを使用できます。**[!UICONTROL ルールベース]**&#x200B;タイプを選択した場合は、すべてのエクスペリエンスイベントのスキーマを使用できます。

1. ルールベースのイベントの場合は、「**[!UICONTROL イベント ID 条件]**」フィールド内でクリックします。簡単な式エディターを使用して、ジャーニーをトリガーするイベントを識別するためにシステムが使用する条件を定義します。
   ![](assets/jo-event6.png)

   この例では、プロファイルの市区町村に基づいて条件を作成しました。つまり、システムはこの条件（**[!UICONTROL 市区町村]**&#x200B;フィールドと&#x200B;**[!UICONTROL パリ]**&#x200B;という値）を満たすイベントを受け取るたびに、ジャーニーにイベントを渡します。

   >[!NOTE]
   >
   >**[!UICONTROL イベント ID 条件]**&#x200B;を定義する際に、高度な式エディターは使用できません。シンプルな式エディターでは、すべての演算子が使用できるわけではなく、データタイプに応じて異なります。例えば、文字列タイプのフィールドには、「次を含む」または「次と等しい」を使用できます。
   >
   >イベントの作成後に新しい列挙値でスキーマを変更する場合、次の手順に従って既存のイベントに変更を適用する必要があります。イベントフィールドの列挙フィールドの選択を解除し、選択を確認して、列挙フィールドを再度選択します。これで、新しい列挙値が表示されます。

1. 名前空間を追加します。この手順はオプションですが、名前空間を追加すると、リアルタイム顧客プロファイルサービスに保存された情報を活用できるのでお勧めです。これは、イベントのキーのタイプを定義します。[この節](../event/about-creating.md#select-the-namespace)を参照してください。

1. プロファイル識別子を定義します。ペイロードフィールドからフィールドを選択するか、イベントに関連付けられた個人を識別する式を定義します。このキーは、名前空間を選択すると自動的に設定されます（編集は可能）。ジャーニーは名前空間に対応するキーを選択します（例えば、メール名前空間を選択すると、メールのキーが選択されます）。[この節](../event/about-creating.md#define-the-event-key)を参照してください。

   ![](assets/jo-event7.png)

1. 「**[!UICONTROL 保存]**」をクリックします。

   これでイベントが設定され、ジャーニーに含まれる準備が整いました。イベントを受信するには、追加の設定手順が必要です。[このページ](../event/additional-steps-to-send-events-to-journey.md)を参照してください。

## ペイロードフィールドの定義 {#define-the-payload-fields}

ペイロード定義を使用すると、ジャーニーのイベントからシステムが受け取ると想定される情報と、イベントに関連付けられている人を識別するためのキーを選択できます。ペイロードは Experience Cloud XDM フィールド定義に基づいています。XDM について詳しくは、[Adobe Experience Platform ドキュメント](https://experienceleague.adobe.com/docs/experience-platform/xdm/home.html?lang=ja){target="_blank"}を参照してください。

1. リストから XDM スキーマを選択し、**[!UICONTROL フィールド]**&#x200B;フィールドまたは「**[!UICONTROL 編集]**」アイコンをクリックします。

   ![](assets/journey8.png)

   スキーマで定義されているすべてのフィールドが表示されます。フィールドのリストは、スキーマによって異なります。特定のフィールドを検索し、フィルターを使用してすべてのノードとフィールドを表示、または選択したフィールドのみを表示できます。スキーマ定義によっては、一部のフィールドが必須となっており、事前に選択されている場合があります。選択を解除することはできません。ジャーニーがイベントを適切に受け取るために必須のフィールドはすべて、デフォルトで選択されます。

   >[!NOTE]
   >
   >システム生成イベントの場合は、「オーケストレーション」フィールドグループが XDM スキーマに追加されていることを確認してください。これにより、[!DNL Journey Optimizer] と連携するために必要な情報がスキーマにすべて含まれるようになります。

   ![](assets/journey9.png)

1. イベントから受け取るフィールドを選択します。これらは、ビジネスユーザーがジャーニーで活用するフィールドです。また、イベントに関連付けられた人物を識別するために使用するキーも含める必要があります（[この節](../event/about-creating.md#define-the-event-key)を参照）。

   >[!NOTE]
   >
   >システム生成イベントの場合は、[!DNL Journey Optimizer] がイベントを識別できるよう、選択されたフィールドのリストに **[!UICONTROL eventID]** フィールドが自動的に追加されます。イベントをプッシュするシステムでは ID を生成しないため、ペイロードプレビューにある ID を使用する必要があります。[この節](../event/about-creating.md#preview-the-payload)を参照してください。

1. 必要なフィールドの選択が完了したら、「**[!UICONTROL OK]**」をクリックするか、**[!UICONTROL Enter]** キーを押します。

   選択したフィールドの数が「**[!UICONTROL フィールド]**」フィールドに表示されます。

   ![](assets/journey12.png)

## 名前空間の選択 {#select-the-namespace}

>[!CONTEXTUALHELP]
>id="ajo_journey_namespace"
>title="ID 名前空間"
>abstract="イベントに関連付けられた顧客プロファイルを識別するためのキーを選択します。"

名前空間を使用すると、イベントに関連付けられた人物の識別に使用するキーのタイプを定義できます。設定は必須ではありません。ジャーニーで、[リアルタイム顧客プロファイル](https://experienceleague.adobe.com/docs/experience-platform/profile/home.html?lang=ja){target="_blank"}から得られる追加情報を取得する場合には必須です。カスタムデータソースを介したサードパーティシステムのデータのみを使用する場合は、名前空間は必要ありません。

事前定義済みのものを使用するか、ID 名前空間サービスを使用して新しく作成できます。[Adobe Experience Platform ドキュメント](https://experienceleague.adobe.com/docs/experience-platform/sources/home.html?lang=ja){target="_blank"}を参照してください。

メイン ID を持つスキーマを選択した場合は、「 **[!UICONTROL プロファイラー識別子]**」および「 **[!UICONTROL 名前空間]**」フィールドに事前入力します。ID を定義していない場合は、_identityMap > id_ がプライマリキーとして選択されます。次に、名前空間を選択する必要があります。キーは、_identityMap > id_ を使用して（**[!UICONTROL 名前空間]**&#x200B;フィールドの下に）事前入力されます。

フィールドを選択すると、プライマリ ID フィールドにタグ付けされます。

![](assets/primary-identity.png)

ドロップダウンリストから名前空間を選択します。

![](assets/journey17.png)

1 つのジャーニーで使用できる名前空間は 1 つだけです。同じジャーニーで複数のイベントを使用する場合は、同じ名前空間を使用する必要があります。[このページ](../building-journeys/journey.md)を参照してください。

>[!NOTE]
>
>ユーザーベースの ID 名前空間のみ選択できます。参照テーブルの名前空間を定義した場合（例：製品参照用の ProductID 名前空間）、**名前空間**&#x200B;ドロップダウンリストでは使用できません。

## プロファイル識別子の定義 {#define-the-event-key}

キーは、イベントのペイロードデータの一部とするフィールドまたはフィールドの組み合わせです。システムはキーを使用することでイベントに関連付けられた人を識別できます。キーには、Experience Cloud ID、CRM ID、メールアドレスなどを使用できます。

アドビのリアルタイム顧客プロファイルデータベースに保存されたデータを使用するには、イベントキーが、[リアルタイム顧客プロファイルサービス](https://experienceleague.adobe.com/docs/experience-platform/profile/home.html?lang=ja){target="_blank"}でプロファイル ID として定義した情報である必要があります。

これにより、プロファイル識別子はイベントと個人プロファイルの間の紐付けを実行できます。メイン ID を持つスキーマを選択した場合、「**[!UICONTROL プロファイル識別子]**」および「**[!UICONTROL 名前空間]**」フィールドはあらかじめ入力されます。ID を定義していない場合は、_identityMap／ID_ がプライマリキーとして選択されます。次に、名前空間を選択する必要があります。キーは、自動的に既存の _identityMap／ID_ を使用します。

フィールドを選択すると、プライマリ ID フィールドにタグ付けされます。

![](assets/primary-identity.png)

CRM ID やメールアドレスなど、別のキーを使用する必要がある場合は、以下の説明のとおり、キーを手動で追加する必要があります。

1. 「**[!UICONTROL プロファイル識別子]**」フィールド内または鉛筆アイコン上をクリックします。

   ![](assets/journey16.png)

1. ペイロードフィールドのリストでキーとして指定したフィールドを選択します。高度な式エディターに切り替えて、より複雑なキーを作成することもできます（例えば、イベントの 2 つのフィールドを連結するなど）。

   ![](assets/journey20.png)

イベントを受け取ると、キーの値によって、システムはイベントに関連付けられた人物を識別できます。キーは名前空間に関連付けられ（[この節](../event/about-creating.md#select-the-namespace)を参照）、Adobe Experience Platform でクエリの実行に使用できます。[このページ](../building-journeys/about-journey-activities.md#orchestration-activities)を参照してください。
このキーは、ある人物がジャーニーにエントリしているかどうかを確認するためにも使用されます。1 人の人物が同じジャーニーの 2 つの異なる場所に存在することはできません。その結果、同じキー（キー CRMID=3224 など）を同じジャーニー内の異なる場所に配置することはできません。

また、より高度な操作を実行する場合は、高度な式関数（**[!UICONTROL 詳細設定モード]**）にアクセスできます。これらの関数を使用すると、形式の変更、フィールドの連結、フィールドの一部のみを考慮する（先頭の 10 文字など）など、特定のクエリの実行に用いる値を操作できます。この[ページ](../building-journeys/expression/expressionadvanced.md)を参照してください。

## ペイロードのプレビュー {#preview-the-payload}

ペイロードのプレビューを使用すると、ペイロード定義を検証できます。

>[!NOTE]
>
>システム生成イベントの場合、イベントを作成する際、ペイロードプレビューを表示する前にイベントを保存して再度開きます。この手順は、ペイロードでイベント ID を生成するために必要です。

1. 「**[!UICONTROL ペイロードを表示]**」アイコンをクリックして、システムが想定するペイロードをプレビューします。

   ![](assets/journey13.png)

   選択したフィールドが表示されていることに注意してください。

   ![](assets/journey14.png)

1. ペイロード定義を検証するプレビューを確認します。

1. その後、イベント送信の担当者とペイロードプレビューを共有できます。このペイロードは、[!DNL Journey Optimizer]にプッシュするイベントのセットアップを設計するのに役立ちます。[このページ](../event/additional-steps-to-send-events-to-journey.md)を参照してください。
