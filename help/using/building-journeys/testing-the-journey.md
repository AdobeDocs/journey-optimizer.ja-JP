---
solution: Journey Optimizer
product: journey optimizer
title: ジャーニーのテスト
description: ジャーニーのテスト方法を説明します
feature: Journeys, Test Profiles
topic: Content Management
role: User
level: Intermediate
keywords: テスト, ジャーニー, チェック, エラー, トラブルシューティング
exl-id: 9937d9b5-df5e-4686-83ac-573c4eba983a
source-git-commit: 0f783c57ba946866cb74c2b16e1807ff963cfbaf
workflow-type: ht
source-wordcount: '1768'
ht-degree: 100%

---

# ジャーニーのテスト{#testing_the_journey}

>[!CONTEXTUALHELP]
>id="ajo_journey_test"
>title="ジャーニーのテスト"
>abstract="公開する前に、テストプロファイルを使用してジャーニーをテストします。これにより、公開前に、個人がジャーニー内をどのように移動するかを分析し、トラブルシューティングを行うことができます。"

ジャーニーを作成したら、公開する前にテストできます。Journey Optimizer では、ジャーニーに沿って進む際にテストプロファイルを表示し、アクティブ化の前に潜在的なエラーを検出する方法として、「テストモード」を提供しています。クイックテストを実行すると、ジャーニーが正しく動作することを確認できるので、自信を持って公開できます。

テストモードでは、テストプロファイルのみがジャーニーにエントリできます。新しいテストプロファイルを作成するか、既存のプロファイルをテストプロファイルに変換することができます。テストプロファイルの詳細については、[この節](../audience/creating-test-profiles.md)を参照してください。

>[!NOTE]
>
>ジャーニーをテストする前に、エラーが発生した場合はすべて解決する必要があります。テストする前にエラーを確認する方法については、[この節](../building-journeys/troubleshooting.md#checking-for-errors-before-testing)を参照してください。

テストモードを使用するには、次の手順に従います。

1. テストモードをアクティブにするには、右上隅にある「**[!UICONTROL テストモード]**」ボタンをクリックします。

   ![](assets/journeytest1.png)

1. ジャーニーに少なくとも 1 つの&#x200B;**待機**&#x200B;アクティビティがある場合、**[!UICONTROL 待機時間]**&#x200B;パラメーターを使用して、各待機アクティビティとイベントのタイムアウトがテストモードで持続する時間を定義します。待機とイベントタイムアウトのデフォルト時間は 10 秒です。これにより、テスト結果を迅速に取得できます。

   ![](assets/journeytest_wait.png)

   >[!NOTE]
   >
   >タイムアウトのある反応イベントをジャーニーで使用する場合、待機時間のデフォルト値は最小値の 40 秒になります。[この節](../building-journeys/reaction-events.md)を参照してください。

1. 「**[!UICONTROL イベントをトリガー]**」ボタンを使用してイベントを設定し、ジャーニーに送信します。

   ![](assets/journeyuctest1.png)

1. 必要に応じて、様々なフィールドを設定します。**プロファイル ID** フィールドに、テストプロファイルの識別に使用するフィールドの値を入力します。これには、メールアドレスなどを使用できます。テストプロファイルに関連するイベントを送信します。[この節](#firing_events)を参照してください。

   ![](assets/journeyuctest1-bis.png)

1. イベントを受け取ったら、「**[!UICONTROL ログを表示]**」ボタンをクリックし、テスト結果を表示して確認します。[この節](#viewing_logs)を参照してください。

   ![](assets/journeyuctest2.png)

1. エラーがある場合は、テストモードを無効にし、ジャーニーを修正してから再度テストします。テストが完了したら、ジャーニーを公開できます。[このページ](../building-journeys/publishing-the-journey.md)を参照してください。

## 重要な注意事項 {#important_notes}

* テストモードでは、インターフェイスを使用してのみイベントを実行できます。API を使用して外部システムからイベントを実行することはできません。
* リアルタイム顧客プロファイルサービスで「テストプロファイル」としてフラグ付けされた個人のみがテストジャーニーにエントリできます。[この節](../audience/creating-test-profiles.md)を参照してください。
* テストモードは、名前空間を使用するドラフトジャーニーでのみ使用できます。テストモードでは、ジャーニーにエントリする人がテストプロファイルであることを確認する必要があるため、Adobe Experience Platform にアクセスできる必要があります。
* ジャーニーにエントリできるテストプロファイルの数は、1 回のテストセッション中に最大 100 です。
* テストモードを無効にすると、過去にジャーニーにエントリしたすべての人々と、現在エントリしているすべての人々がジャーニーから削除されます。また、レポートも消去します。
* テストモードは、必要であれば何回でも有効または無効にできます。
* テストモードがアクティブになっているときは、ジャーニーを変更できません。テストモードではジャーニーを直接公開できるので、事前にテストモードを無効にしておく必要はありません。
* 分割に達すると、常に一番上の分岐を選択します。テストで別のパスを選択する場合は、分割された分岐の位置を再編成できます。
* パフォーマンスを最適化し、古くなったリソースの使用を防ぐために、1 週間トリガーされていないテストモードのジャーニーはすべて、**ドラフト**&#x200B;ステータスに戻ります。
* テストモードでトリガーされるイベントは、専用のデータセットに保存されます。これらのデータセットには、次のラベルが付けられます：`JOtestmode - <schema of your event>`
* 複数のイベントを含むジャーニーをテストする場合は、各イベントを順番にトリガーする必要があります。イベントの送信が早すぎる（最初の待機ノードが終了する前）または遅すぎる（設定されたタイムアウトの後）場合、イベントは破棄され、プロファイルがタイムアウトパスに送信されます。定義したウィンドウ内にペイロードを送信して、イベントペイロードフィールドへの参照が有効なままであることを常に確認します。
* テストモードを開始する際は、ジャーニーで設定した[開始日時と終了日時](journey-properties.md#dates)の選択ウィンドウに現在の時刻が含まれていることを確認します。それ以外の場合、トリガーしたテストイベントは通知なしで破棄されます。

<!--
* Fields from related entities are hidden from the test mode.
-->

## イベントのトリガー {#firing_events}

>[!CONTEXTUALHELP]
>id="ajo_journey_test_configuration"
>title="テストモードを設定"
>abstract="ジャーニーに複数のイベントが含まれる場合は、ドロップダウンリストを使用してイベントを選択します。次に、各イベントに対して、渡されるフィールドと送信するイベントの実行を設定します。"

「**[!UICONTROL イベントをトリガー]**」ボタンを使用して、ユーザーがジャーニーにエントリできるようにするイベントを設定します。


### 前提条件 {#trigger-events-prerequisites}

前提条件として、Adobe Experience Platform でテストプロファイルというフラグの付いたプロファイルを把握しておく必要があります。実際、テストモードでは、これらのプロファイルのみがジャーニーで許可されます。

イベントには ID を含める必要があります。必要な ID は、イベント設定に応じて異なります。この ID には、ECID やメールアドレスなどを使用できます。このキーの値は、**プロファイル識別子**&#x200B;フィールドに追加する必要があります。

ジャーニーでエラー `ERR_MODEL_RULES_16` が発生してテストモードを有効にできない場合は、チャネルアクションを使用する際に、使用するイベントに [ID 名前空間](../audience/get-started-identity.md)が含まれていることを確認してください。

ID 名前空間は、テストプロファイルを一意に識別するために使用されます。例えば、メールを使用してテストプロファイルを識別する場合は、ID 名前空間の&#x200B;**メール**&#x200B;を選択する必要があります。一意の識別子が電話番号の場合は、ID 名前空間の&#x200B;**電話**&#x200B;を選択する必要があります。

>[!NOTE]
>
>* テストモードでイベントをトリガーすると、実際のイベントが生成されます。つまり、このイベントをリッスンしている他のジャーニーもヒットします。
>
>* テストモードの各イベントが正しい順序で、設定された待機ウィンドウ内でトリガーされることを確認します。例えば、60 秒の待機時間がある場合、2 番目のイベントは、その 60 秒の待機時間が経過し、タイムアウト制限が期限切れになる前にのみトリガーする必要があります。
>

### イベント設定 {#trigger-events-configuration}

ジャーニーに複数のイベントが含まれる場合は、ドロップダウンリストを使用してイベントを選択します。次に、各イベントに対して、渡されるフィールドと送信するイベントの実行を設定します。インターフェイスは、イベントペイロードに正しい情報を渡し、情報タイプが正しいことを確認するのに役立ちます。テストモードでは、後で使用するために、テストセッションで最後に使用したパラメーターが保存されます。

![](assets/journeytest4.png)

このインターフェイスを使用すると、単純なイベントパラメーターを渡すことができます。イベント内のコレクションや他の高度なオブジェクトを渡す場合は、「**[!UICONTROL コードビュー]**」をクリックして、ペイロードのコード全体を表示し、変更することができます。例えば、技術ユーザーが作成したイベント情報をコピーして貼り付けることができます。

![](assets/journeytest5.png)

技術ユーザーは、このインターフェイスを使用してイベントペイロードを作成して、サードパーティのツールを使用せずにイベントをトリガーすることもできます。

「**[!UICONTROL 送信]**」ボタンをクリックすると、テストが開始されます。ジャーニー内の個人の進行状況は、視覚的なフローで表現されます。個人がジャーニー間を移動すると、パスは徐々に緑に変わります。エラーが発生した場合は、対応する手順に警告記号が表示されます。その警告記号上にカーソルを置くと、エラーに関する詳細情報が表示され、（利用可能な場合は）詳細情報にアクセスできます。

![](assets/journeytest6.png)

イベント設定画面で別のテストプロファイルを選択し、再びテストを実行すると、視覚的なフローが消去され、新しい個人のパスが表示されます。

テストでジャーニーを開くと、最後に実行されたテストに対応するパスが表示されします。

## ルールベースのジャーニーのテストモード {#test-rule-based}

テストモードは、ルールベースのイベントを使用するジャーニーでも使用できます。ルールベースのイベントについて詳しくは、[このページ](../event/about-events.md)を参照してください。

イベントをトリガーする際、**イベント設定**&#x200B;画面で、テストに合格するイベントパラメーターを定義できます。イベント ID 条件を表示するには、右上隅のツールチップアイコンをクリックします。各フィールド（ルール評価の一部）の横にあるツールヒントも利用できます。

![](assets/jo-event8.png)

## ビジネスイベントのテストモード {#test-business}

[ビジネスイベント](../event/about-events.md)を使用する場合、テストモードを使用して、ジャーニーに 1 つのテストプロファイルエントリをトリガーし、イベントをシミュレートして、適切なプロファイル ID を渡します。テストでは、イベントパラメーターと、ジャーニーにエントリするテストプロファイルの識別子を渡す必要があります。テストモードには、ビジネスイベントに基づくジャーニーに使用できる「コードビュー」モードはありません。

初めてビジネスイベントをトリガーするときに、同じテストセッションでビジネスイベントの定義を変更することはできません。同じ識別子または別の識別子を渡して、同じ人物または別の人物をジャーニーにエントリさせる必要があります。ビジネスイベントパラメーターを変更する場合は、テストモードを停止して再開する必要があります。

## ログを表示 {#viewing_logs}

>[!CONTEXTUALHELP]
>id="ajo_journey_test_logs"
>title="テストモードログ"
>abstract="「**ログを表示**」ボタンをクリックすると、テスト結果が JSON 形式で表示されます。この結果では、ジャーニー内の個人の数とそのステータスが表示されます。"

「**[!UICONTROL ログを表示]**」ボタンを使用すると、テスト結果を表示できます。このページには、ジャーニーの現在の情報が JSON 形式で表示されます。ボタンを使用すると、ノード全体をコピーできます。ジャーニーのテスト結果を更新するには、ページを手動で更新する必要があります。

![](assets/journeytest3.png)


>[!NOTE]
>
>テストログで、サードパーティシステム（データソースまたはアクション）の呼び出し時にエラーが発生した場合は、エラーコードとエラー応答が表示されます。

現在、ジャーニー内にいる個人の数（技術的にはインスタンスと呼ばれます）が表示されます。各個人に表示される便利な情報を次に示します。

* _ID_：ジャーニー内の個人の内部 ID。デバッグ目的で使用できます。
* _currentstep_：個人がジャーニーにいるステップ。アクティビティを識別しやすくするために、アクティビティにラベルを追加することをお勧めします。
* _currentstep_ > フェーズ：個人のジャーニーのステータス（実行中、完了、エラーまたはタイムアウト）。詳しくは、以下を参照してください。
* _currentstep_ > _extraInfo_：エラーの説明と、その他のコンテキスト情報。
* _currentstep_ > _fetchErrors_：この手順中に発生したデータ取得エラーに関する情報。
* _externalKeys_：イベントで定義されているキー式の値。
* _enrichedData_：ジャーニーがデータソースを使用している場合にジャーニーが取得したデータ。
* _transitionHistory_：個人が踏んだ手順のリスト。イベントの場合、ペイロードが表示されます。
* _actionExecutionErrors_：発生したエラーに関する情報。

個人のジャーニーには様々なステータスがあります。

* _実行中_：個人は現在ジャーニーの途中にいます。
* _完了_：個人はジャーニーの最後にいます。
* _エラー_：エラーが発生したため、個人のジャーニーは停止しました。
* _タイムアウト_：時間がかかり過ぎたので、個人のジャーニーは停止しました。

テストモードでイベントをトリガーすると、ソースの名前が付いたデータセットが自動的に生成されます。

テストモードでは、エクスペリエンスイベントが自動的に作成され、Adobe Experience Platform に送信されます。このエクスペリエンスイベントのソース名は、「Journey Orchestration テストイベント」です。

