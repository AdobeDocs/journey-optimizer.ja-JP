---
solution: Journey Optimizer
title: 外部データソースとカスタムアクションでのスループットの制限
description: 外部データソースとカスタムアクションでのスループットの制限
source-git-commit: 8e3753927e16cc0c4bebf83be2fded6f19d9487e
workflow-type: tm+mt
source-wordcount: '619'
ht-degree: 1%

---


# 使用例：外部データソースとカスタムアクションでのスループットの制限{#limit-throughput}

## ユースケースの説明

Adobe Journey Optimizerを使用すると、実務担当者は、カスタムアクションとデータソースを使用して、外部システムに API 呼び出しを送信できます。

これは、を使用しておこなうことができます。

* **データソース**:外部システムから情報を収集し、その情報をジャーニーコンテキストで使用する場合（例えば、プロファイル都市の天気情報を取得し、それに基づいて専用のジャーニーフローを持つ場合）。

* **カスタムアクション**:外部システムに情報を送信する ( 例えば、プロファイル情報、オーディエンスデータ、ジャーニーコンテキストと共にJourney Optimizerのオーケストレーション機能を使用して外部ソリューションから e メールを送信する )。

外部データソースやカスタムアクションを扱う場合は、ジャーニーのスループットを制限して、外部システムを保護する必要が生じる場合があります。単一のジャーニーの場合は最大 5,000 インスタンス/秒、セグメントトリガーの場合は最大20000インスタンス/秒です。 エンドポイントレベルでキャッピングの制限を定義すると、Journey Optimizerのキャッピング API を使用して、これらの外部システムに圧倒されないようにできます。 ただし、制限に達した後の残りのリクエストはすべて破棄されます。

この節では、スループットを最適化するために使用できる回避策を見つけます。 外部システムとの統合方法について詳しくは、 [ページ](../configuration/external-systems.md).

## 実装

の場合 **セグメントトリガージャーニー**&#x200B;に値を指定すると、ジャーニーのスループットに影響を与える「セグメントを読み取り」アクティビティのスロットル率を定義できます。  [詳細情報](../building-journeys/read-segment.md)

![](assets/limit-throughput-1.png)

この値は、1 秒あたり 500 から 20,000 のインスタンスに変更できます。 500 秒未満にする必要がある場合は、待機アクティビティと共に「割合分割」条件を追加して、ジャーニーを複数の分岐に分割し、特定の時間に実行させることもできます。

![](assets/limit-throughput-2.png)

次に、 **セグメントトリガージャーニー** ～の集団との連携 **10,000 個のプロファイル** をサポートする外部システムにデータを送信 **100 リクエスト/秒**.

1. 「セグメントを読み取り」を定義して、スループットが 500 プロファイル/秒のプロファイルを読み取ることができます。つまり、すべてのプロファイルを読み取るのに 20 秒かかります。 2 つ目の 1 では、500 個、2 つ目の 2 つ目の 500 個などを読みます。

1. 次に、20%の分割を持つ「割合分割」条件アクティビティを追加して、各分岐の各分岐の各秒に 100 個のプロファイルを持つことができます。

1. その後、各ブランチに特定のタイマーを持つ待機アクティビティを追加します。 ここでは、1 つ 1 つに対して 30 秒の待機を設定しました。 毎秒、100 個のプロファイルが各ブランチにフローされます。

   * ブランチ 1 では、30 秒待ちます。つまり、
      * 2 番目の 1 では、100 件のプロファイルが 2 番目の 31 まで待機します
      * 2 番目の日には、100 人のプロファイルが 2 番目の 32 まで待ちます。
   * ブランチ 2 では、60 秒待ちます。つまり、
      * 2 番目の 1 では、100 件のプロファイルが 2 番目の 61 (1&#39;01&#39;) を待ちます
      * 2 番目の日には、100 人のプロファイルが 2 番目の 62(1&#39;02&#39;&#39;) まで待ちます。
   * すべてのプロファイルを読み取るのに最大 20 秒が必要となることを知っていると、各分岐間の重複はなく、2 番目の 20 が条件にプロファイルがフローされる最後の 2 つ目となります。 2 番目の 31 ～ 51 秒の間に、ブランチ 1 内のすべてのプロファイルが処理されます。 2 番目の 61(1&#39;01&quot;) と 2 番目の 81(1&#39;21&quot;) の間では、ブランチ 2 内のすべてのプロファイルが処理されます。

   * ガードレールとして、特に外部システムが 100 リクエスト/秒しかサポートしていない場合に、1 つのブランチあたり 100 個未満のプロファイルを持つ 6 つ目のブランチを追加することもできます。



>[!IMPORTANT]
>
>回避策と同様に、実稼動環境に移行する前にそのソリューションを十分にテストし、必要に応じて実行するようにしてください。

追加のガードレールとして、キャッピング機能を使用することもできます。

>[!NOTE]
>
>サンドボックスのすべてのジャーニーに対してグローバルになることでエンドポイントを保護するキャッピング機能とは異なり、この回避策はジャーニーレベルでのみ機能します。 つまり、複数のジャーニーが並行して実行され、同じエンドポイントをターゲットとしている場合、ジャーニーを設計する際に、その点を考慮に入れる必要があります。 したがって、この回避策はすべての使用例に適しているわけではありません。

